import { BigNumber } from 'bignumber.js';

let dataArray = [
    
    // 2020
    // Juli: hier hatte ich 3 Einzahlungen    
    {from: "2020-07-16 23:56:30", to: "2020-08-01 00:00:00", amount: "9890"},           // Transfer
    {from: "2020-07-17 14:02:40", to: "2020-08-01 00:00:00", amount: "8090.801"},       // Transfer
    {from: "2020-07-17 16:56:20", to: "2020-08-01 00:00:00", amount: "24813.062"},      // Transfer

    // August: Summe aus Juli
    {from: "2020-08-01 00:00:00", to: "2020-09-01 00:00:00", amount: "42793.863"},      // Besitz
    // hier hatte ich 5 Einzahlungen
    {from: "2020-08-07 14:40:40", to: "2020-09-01 00:00:00", amount: "19818.062"},      // Transfer
    {from: "2020-08-12 11:14:40", to: "2020-09-01 00:00:00", amount: "39076.784"},      // Transfer
    {from: "2020-08-12 17:39:50", to: "2020-09-01 00:00:00", amount: "35134.73"},       // Transfer
    {from: "2020-08-20 17:55:30", to: "2020-09-01 00:00:00", amount: "32584.283"},      // Transfer
    {from: "2020-08-25 00:33:40", to: "2020-09-01 00:00:00", amount: "21960.917"},      // letzter Transfer

    // 2020 Rest
    {from: "2020-09-01 00:00:00", to: "2020-10-01 00:00:00", amount: "191368.639"},
    {from: "2020-10-01 00:00:00", to: "2020-11-01 00:00:00", amount: "191368.639"},
    {from: "2020-11-01 00:00:00", to: "2020-12-01 00:00:00", amount: "191368.639"},
    {from: "2020-12-01 00:00:00", to: "2021-01-01 00:00:00", amount: "191368.639"},

    // 2021
    {from: "2021-01-01 00:00:00", to: "2021-02-01 00:00:00", amount: "191368.639"},
    {from: "2021-02-01 00:00:00", to: "2021-03-01 00:00:00", amount: "191368.639"},
    {from: "2021-03-01 00:00:00", to: "2021-04-01 00:00:00", amount: "191368.639"},
    {from: "2021-04-01 00:00:00", to: "2021-05-01 00:00:00", amount: "191368.639"},
    {from: "2021-05-01 00:00:00", to: "2021-06-01 00:00:00", amount: "191368.639"},
    {from: "2021-06-01 00:00:00", to: "2021-07-01 00:00:00", amount: "191368.639"},
    {from: "2021-07-01 00:00:00", to: "2021-08-01 00:00:00", amount: "191368.639"},
    {from: "2021-08-01 00:00:00", to: "2021-09-01 00:00:00", amount: "191368.639"},
    {from: "2021-09-01 00:00:00", to: "2021-10-01 00:00:00", amount: "191368.639"},
    {from: "2021-10-01 00:00:00", to: "2021-11-01 00:00:00", amount: "191368.639"},
    {from: "2021-11-01 00:00:00", to: "2021-12-01 00:00:00", amount: "191368.639"},
    {from: "2021-12-01 00:00:00", to: "2022-01-01 00:00:00", amount: "191368.639"},
    
    // 2022
    {from: "2022-01-01 00:00:00", to: "2022-02-01 00:00:00", amount: "191368.639"},
    {from: "2022-02-01 00:00:00", to: "2022-03-01 00:00:00", amount: "191368.639"},
    {from: "2022-03-01 00:00:00", to: "2022-04-01 00:00:00", amount: "191368.639"},
    {from: "2022-04-01 00:00:00", to: "2022-05-01 00:00:00", amount: "191368.639"},
    {from: "2022-05-01 00:00:00", to: "2022-06-01 00:00:00", amount: "191368.639"},
    {from: "2022-06-01 00:00:00", to: "2022-07-01 00:00:00", amount: "191368.639"},
    {from: "2022-07-01 00:00:00", to: "2022-08-01 00:00:00", amount: "191368.639"},
    {from: "2022-08-01 00:00:00", to: "2022-09-01 00:00:00", amount: "191368.639"},
    {from: "2022-09-01 00:00:00", to: "2022-10-01 00:00:00", amount: "191368.639"},
    {from: "2022-10-01 00:00:00", to: "2022-11-01 00:00:00", amount: "191368.639"},
    {from: "2022-11-01 00:00:00", to: "2022-12-01 00:00:00", amount: "191368.639"},
    {from: "2022-12-01 00:00:00", to: "2023-01-01 00:00:00", amount: "191368.639"},

    // 2023
    {from: "2023-01-01 00:00:00", to: "2023-02-01 00:00:00", amount: "191368.639"},
    {from: "2023-02-01 00:00:00", to: "2023-03-01 00:00:00", amount: "191368.639"},
    {from: "2023-03-01 00:00:00", to: "2023-04-01 00:00:00", amount: "191368.639"},
    {from: "2023-04-01 00:00:00", to: "2023-05-01 00:00:00", amount: "191368.639"},
    {from: "2023-05-01 00:00:00", to: "2023-06-01 00:00:00", amount: "191368.639"},
    {from: "2023-06-01 00:00:00", to: "2023-07-01 00:00:00", amount: "191368.639"},
    {from: "2023-07-01 00:00:00", to: "2023-08-01 00:00:00", amount: "191368.639"},
    {from: "2023-08-01 00:00:00", to: "2023-09-01 00:00:00", amount: "191368.639"},
    {from: "2023-09-01 00:00:00", to: "2023-10-01 00:00:00", amount: "191368.639"},
    {from: "2023-10-01 00:00:00", to: "2023-11-01 00:00:00", amount: "191368.639"},
    {from: "2023-11-01 00:00:00", to: "2023-12-01 00:00:00", amount: "191368.639"},
    {from: "2023-12-01 00:00:00", to: "2024-01-01 00:00:00", amount: "191368.639"},

    // 2024
    {from: "2024-01-01 00:00:00", to: "2024-02-01 00:00:00", amount: "191368.639"},
    {from: "2024-02-01 00:00:00", to: "2024-03-01 00:00:00", amount: "191368.639"},
    {from: "2024-03-01 00:00:00", to: "2024-04-01 00:00:00", amount: "191368.639"},
    {from: "2024-04-01 00:00:00", to: "2024-05-01 00:00:00", amount: "191368.639"},
    {from: "2024-05-01 00:00:00", to: "2024-06-01 00:00:00", amount: "191368.639"},
    {from: "2024-06-01 00:00:00", to: "2024-07-01 00:00:00", amount: "191368.639"},
    {from: "2024-07-01 00:00:00", to: "2024-08-01 00:00:00", amount: "191368.639"},
    {from: "2024-08-01 00:00:00", to: "2024-09-01 00:00:00", amount: "191368.639"},
    {from: "2024-09-01 00:00:00", to: "2024-10-01 00:00:00", amount: "191368.639"},
    {from: "2024-10-01 00:00:00", to: "2024-11-01 00:00:00", amount: "191368.639"},
    {from: "2024-11-01 00:00:00", to: "2024-12-01 00:00:00", amount: "191368.639"},
    {from: "2024-12-01 00:00:00", to: "2025-01-01 00:00:00", amount: "191368.639"},

    // 2025
    {from: "2025-01-01 00:00:00", to: "2025-02-01 00:00:00", amount: "191368.639"},
    {from: "2025-02-01 00:00:00", to: "2025-03-01 00:00:00", amount: "191368.639"},
    {from: "2025-03-01 00:00:00", to: "2025-04-01 00:00:00", amount: "191368.639"},
    {from: "2025-04-01 00:00:00", to: "2025-05-01 00:00:00", amount: "191368.639"},
    {from: "2025-05-01 00:00:00", to: "2025-06-01 00:00:00", amount: "191368.639"},
    {from: "2025-06-01 00:00:00", to: "2025-07-01 00:00:00", amount: "191368.639"},
    {from: "2025-07-01 00:00:00", to: "2025-08-01 00:00:00", amount: "191368.639"},
    {from: "2025-08-01 00:00:00", to: "2025-09-01 00:00:00", amount: "191368.639"},
    {from: "2025-09-01 00:00:00", to: "2025-10-01 00:00:00", amount: "191368.639"},
    {from: "2025-10-01 00:00:00", to: "2025-10-28 11:30:20", amount: "191368.639"}

];

function calcByDays(amount: BigNumber, days: BigNumber) : BigNumber {

    //console.log("amount:", amount.toString());
    //console.log("days:", days.toString());

    let vtho = new BigNumber(days);
    vtho = vtho.multipliedBy(amount);
    vtho = vtho.multipliedBy(0.000432);

    const truncated = vtho.decimalPlaces(8, BigNumber.ROUND_DOWN);

    return truncated;
}


// 1000 ms * 60 s * 60 min * 24 h = 86,400,000 ms
const MS_PER_DAY = 1000 * 60 * 60 * 24;

let vthoSum = new BigNumber(0);

for (const data of dataArray) {
    // 1. Datum in Millisekunden (UTC) umwandeln
    // Wichtig: Die `Date`-Konstruktion in JS interpretiert "YYYY-MM-DD HH:MM:SS" als UTC,
    // wenn kein Zeitzonen-Offset angegeben wird.
    const fromMs = Date.parse(data.from + ' UTC');
    const toMs = Date.parse(data.to + ' UTC');

    const diffMilliseconds = toMs - fromMs;
    const diffSeconds = diffMilliseconds / 1000;
    let diffMinutes = new BigNumber(diffSeconds);
    diffMinutes = diffMinutes.dividedBy(60);
    let diffHours = new BigNumber(diffMinutes);
    diffHours = diffHours.dividedBy(60);
    let diffDays = new BigNumber(diffHours);
    diffDays = diffDays.dividedBy(24);

    let bignumberAmount = new BigNumber(data.amount);

    const vtho = calcByDays(bignumberAmount, diffDays);

    console.log('from: ' + data.from + ' | to: ' + data.to + ' | ' + vtho);

    vthoSum = vthoSum.plus(vtho);
}

console.log('\nvthoSum: ' + vthoSum);





